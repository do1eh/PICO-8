pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
function _init()

  x = 0
  y = 32
  spiegeln=false
  speed = 0
gravitation=0.4
sprungkraft=-4
gameover=false
win=false

end

function _update()
speed += gravitation
 y += speed
 

-- Alle vier Ecken der Hitbox prれもfen
if is_tot(x+1 , y + 4) or 
   is_tot(x+1 , y + 4) or 
   is_tot(x+1 , y + 7) or 
   is_tot(x+1 + 6, y + 7) then
   gameover = true
end

if is_win(x+1 , y + 4) or 
   is_win(x+1 , y + 4) or 
   is_win(x+1 , y + 7) or 
   is_win(x+1 + 6, y + 7) then
   win = true
end
 
if not gameover and not win then 


if speed > 0 then 
   if is_tot(x + 1, y + 8) or is_solid(x + 6, y + 8) then
         local tile_y = flr((y + 7) / 8)
         y = tile_y * 8 
         speed = 0
      end
  end

if (btnp(⬆️) or btnp(❎)) and speed == 0 and is_solid(x + 1, y + 8) then 
    speed = sprungkraft
  end

if btn(➡️) then
   local block=mget(flr((x+8)/8),flr(y/8))
   if not fget(block,0) then
   x=x+1
   end
   spiegeln=false
end

if btn(⬅️) then 
   x=x-1
   spiegeln=true
end
 else
if btnp(❎) then
   --reset
   _init()
end
end      
end


function _draw()
cls()


map()
if not win then
   spr(1,x,y,1,1,spiegeln)
end   

--rect(x+1, y+4, x+6, y+7, 8)
if gameover then
   rectfill(20,30,90,55,10)
   print("game over",34,36,8)
   print("druecke ❎",34,46,8)
   
end

if win then
   rectfill(20,30,90,55,10)
   print("gewonnen!!",34,36,8)
   print("druecke ❎",34,46,8)
   
end
end
-->8
function is_solid(px, py)
    local tile_x = flr(px / 8)
    local tile_y = flr((py + 7) / 8) 
    local sprite_id = mget(tile_x, tile_y)
   return fget(sprite_id, 0)
end


function is_tot(px, py)
    local tile_x = px \ 8
    local tile_y = py \ 8
    
    local sprite_id = mget(tile_x, tile_y)
    return fget(sprite_id, 1)
end

function is_win(px, py)
    local tile_x = px \ 8
    local tile_y = py \ 8
    
    local sprite_id = mget(tile_x, tile_y)
    return fget(sprite_id, 7)
end

__gfx__
000000002887777233333333cccccccc44444444b3bb3333666666666666666666666666ccc77ccccccccccc6686666600000000000000000000000000000000
000000008877070733333333cccccccc4444444433bbb3bb6666666666006666666699c6cc777777cccccccc6886668800000000000000000000000000000000
008880002477070743344344cccccccc444444443333bb3b6666666666666660699c6666cc777777cccccccc6666886600000000000000000000000000000000
080008002877777744444444cccccccc44444444333b33b3666666660060066666666666c777777ccccccccc6666666600000000000000000000000000000000
080808002887777244444444cccccccc4444444433bb3b33666666666666660066669c66c777777ccccc8ccc6688668600000000000000000000000000000000
080008008844aa4244444444cccccccc44444444b333bb33666666660066666666699666c7777ccc8cc898c88866666600000000000000000000000000000000
008880008488888444444444cccccccc44444444b3b3333b6666666666666006cc666666cccccccc98c898c86666688600000000000000000000000000000000
000000000002200044444444cccccccc4444444433b33b3b666666666006666669666666cccccccc98c898c86866886600000000000000000000000000000000
00000000000000000000000000000000cccccccc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000caaaaa9c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000caaa7a9c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000caa7aa9c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000ccaaa9cc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000ccca9ccc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000ccca9ccc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000ccaaa9cc0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000010000000101010002000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0303030903030303090303030309030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0305030303050303030309030303030300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0504050305040503030a0303030a031400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0304030303040302020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0304030a0202020404040404040404040c000000000c0c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020202020404040404040404040404040c0c0c0c0c0c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0b0b0606070606080606070606060806000c0c0c0c0c0c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0607060b060606080606060b0606070600000c0c0c0c0c0c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0606060608060606060806060606060b00000000000c0c0c0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
060706060606060606060606060b060600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
06060808060806070b0607060606060606000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0608060606080606060606060b06060b06060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
